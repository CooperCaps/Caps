<!DOCTYPE html>
<html lang="en" >
<head>
  <meta charset="UTF-8">
  <title>CodePen - Working Fallout New Vegas Pip-Boy (Bootstrap)</title>
  <link rel='stylesheet' href='https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css'><link rel="stylesheet" href="./style.css">
    <script src="https://cdn.jsdelivr.net/npm/web3@1.5.0/dist/web3.min.js"></script>


</head>
<body>

<!-- partial:index.partial.html -->
  <img src="pipboy.png" alt="Overlay Image" class="overlay-image">

<div id="frame" class="frame">

  <div class="piece output container">

    <div class="pipboy">

      <ul class="pip-foot">
        <li class="active"><a href="#items" data-toggle="tab">Items</a></li>
        <li><a href="#stats" data-toggle="tab">Stake</a></li>
        <li><a href="#quests" data-toggle="tab">Swap</a></li>
        <li><a href="#misc" data-toggle="tab">Misc</a></li>
        <li><a href="#radio" data-toggle="tab">Radio</a></li>
      </ul>

      <div class="tab-content">

        <div class="tab-pane fade in active" id="items">
          <h3 class="pip-title">Items</h3>
          <ul class="pip-head">
          <li><b>Address</b> <span id="address" onclick="connectWallet()">CONNECT</span></li>
            <li><b>HP</b> ???</li>
            <li><span class="fade-a"><b>DT</b> ???</span><span class="fade-b"><b>DR</b> ???</span></li>
              <li><b>Caps</b> <span id="capsBalance">Loading</span></li> 
          </ul>
          <div class="pip-body">
            <ul class="options">
              <li class="disabled"><input type="radio" id="radio1" name="radio">
                <label for="radio1">Brass Knuckles </label>
              </li>
              <li class="disabled"><input type="radio" checked="checked" id="radio2" name="radio">
                <label for="radio2">Hunting Rifle</label>
              </li>
              <li class="disabled"><input type="radio" id="radio3" name="radio">
                <label for="radio3">Long Fuse Dynamite (11)</label>
              </li>
              <li class="disabled"><input type="radio" id="radio4" name="radio">
                <label for="radio4">Plasma Pistol <label>
              </li>
            </ul>
            <div class="info">
              <div class="right-options">
                <a href="#" class="disabled">Mint NFT</a>
              </div>
              <div class="info-body">
                <ul class="info-table">
                  <li class="vboy-wrap">
                    <div class="item-icon"><span class="icon"><img class="filter" src="https://cybersandbox.ca/resources/556mm_round_icon.png"></span>0</div>
                    <div class="vboy filter"></div>
                  </li>
                  <li><b>STR</b> ???</li>
                  <li class="clear"><span class="fade-a"><b>DAM</b> ???</span><span class="fade-b"><b>DPS</b> ???</span></li>
                  <li><b>WG</b> ???</li>
                  <li><b>VAL</b> ???</li>
                  <li><b>CND</b> <span class="condition"><span class="fill" style="width: 83%;"></span></span></li>
                  <li class="span-2">No Ammo</li>
                </ul>
                <p class="extra"><b>MODS</b> ???</p>
              </div>
            </div>
          </div>
        </div>

        <div class="tab-pane fade" id="stats">
          <h3 class="pip-title">Stake</h3>
          <ul class="pip-head">
            <li><b>DEPOSITED</b> --</li>
            <li><b>CLAIMED</b> ---</li>
            <li><b>CLAIMABLE</b> ---</li>
            <li><b>APY</b> 73.8%</li>
          </ul>
          <div class="pip-body">
            <ul class="side-menu">
              <li class="active"><a href="#cnd" data-toggle="tab">EARN</a></li>
              <li><a href="#rad" data-toggle="tab">CAPS</a></li>
              <li><a href="#eff" data-toggle="tab">CAPS/ETH</a></li>
              <li class="disabled"><a href="#">CAPS/USDT</a></li>
              <li class="disabled"><a href="#">//Null</a></li>
              <li class="disabled"><a href="#">//Null</a></li>
            </ul>
            <div class="tab-content">
              <div class="tab-pane fade in active" id="cnd">
                <div class="stats-page">
                  <h4>Rewards</h4>

                  <div class="right-options">
                    <a href="#">(0) CAPS EARNED</a>
                    
                  </div>
                </div>
              </div>
              <div class="tab-pane fade" id="rad">
                <div class="stats-page">
                  <h4>DETAILS</h4>
                  <ul>
                    <li>No data.</li>
                  </ul>
                </div>
              </div>
              <div class="tab-pane fade" id="eff">
                <div class="stats-page">
                  <h4>DETAILS</h4>
                  <ul>
                    <li>No data.</li>
               
                  </ul>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="tab-pane fade" id="quests">
          <h3 class="pip-title">Swap</h3>
          <div class="pip-body">
            <ul class="options">
              <li class="active"><a href="#quest-1" data-toggle="tab">Coming Soon</a></li>
              <li class="disabled" data-toggle="tab">//Null</a></li>
              <li class="disabled"><label>//Null</labe>
              </li>
            </ul>
            <div class="tab-content">
              <div class="info tab-pane active fade in" id="quest-1">
                <div class="post">
                  <p>Swap Caps for ETH and other tokens directly in your Pipboy </p>
                </div>
              </div>

              <div class="info tab-pane fade" id="quest-2">
                <div class="post">
                  <p>Fallput: Battle Royale</p>
                </div>
              </div>

            </div>
          </div>
        </div>

        <div class="tab-pane fade" id="misc">
          <h3 class="pip-title">Misc</h3>
          <div class="pip-body">
            <ul class="options">
              <li class="active"><a href="#misc-3" data-toggle="tab">The Story</a></li>
              <li><a href="#misc-2" data-toggle="tab">Airdrop</a></li>
              <li><a href="#misc-4" data-toggle="tab">Referal Link</a></li>
              <li><a href="#misc-1" data-toggle="tab">Backlight Color</a></li>

            </ul>
            <div class="tab-content">
              <div class="info tab-pane fade" id="misc-1">
                <div class="post">
                  <p>Select HUD / Backlight Color</p>
                  <form class="colors" onChange="getColor();">
                    <input id="b-amber" type="radio" name="colors" value="amber" checked>
                    <label for="b-amber">Amber</label>
                    <input id="b-red" type="radio" name="colors" value="red">
                    <label for="b-red">Red</label>
                    <input id="b-green" type="radio" name="colors" value="green">
                    <label for="b-green">Green</label>
                    <input id="b-blue" type="radio" name="colors" value="blue">
                    <label for="b-blue">Blue</label>
                    <input id="b-white" type="radio" name="colors" value="white">
                    <label for="b-white">White</label>
                    <input id="b-black" type="radio" name="colors" value="black" onChange="getColor();">
                    <label for="b-black">Science!</label>
                  </form>
                </div>
              </div>

              <div class="info tab-pane fade" id="misc-2">
                <div class="post">
                  <p>Patricipate in the CAPS airdrop. Any adderss can contribute 0.00025 ETH to 0.0025ETH to claim the airdrop. All funds are directly added to initial liquidity. This helps fund initial liquidity while also keeping an even fair distribution.</p>
                </div>
                <br>
               
                
                 
<center><span id="amountDisplay">0.00025 ETH</span>
<button id="minButton" onclick="decreaseToMinimum()">Min</button>
<button id="decreaseButton" onmousedown="startDecrementInterval()" onmouseup="stopDecrementInterval()">-</button>
<button id="increaseButton" onmousedown="startIncrementInterval()" onmouseup="stopIncrementInterval()">+</button>
<button id="maxButton" onclick="increaseToMaximum()">Max</button></center><br><br>
<center><button id="claimTheCaps" onclick="claimCaps()">CLAIM CAPS</button></center>
<script>
    // JavaScript code goes here
    let currentAmount = 0.00025; // Initial amount
    const minAmount = 0.00025;
    const maxAmount = 0.0025;
    let incrementInterval;
    let decrementInterval;

    function updateAmountDisplay() {
        document.getElementById('amountDisplay').textContent = currentAmount.toFixed(5) + ' ETH';
    }

    function increaseAmount() {
        if (currentAmount < maxAmount) {
            currentAmount += 0.00001; // Increment by 0.00001 ETH
            updateAmountDisplay();
        }
    }

    function decreaseAmount() {
        if (currentAmount > minAmount) {
            currentAmount -= 0.00001; // Decrement by 0.00001 ETH
            updateAmountDisplay();
        }
    }

    function increaseToMaximum() {
        currentAmount = maxAmount;
        updateAmountDisplay();
    }

    function decreaseToMinimum() {
        currentAmount = minAmount;
        updateAmountDisplay();
    }

    function startIncrementInterval() {
        incrementInterval = setInterval(function() {
            increaseAmount();
        }, 100);
    }

    function stopIncrementInterval() {
        clearInterval(incrementInterval);
    }

    function startDecrementInterval() {
        decrementInterval = setInterval(function() {
            decreaseAmount();
        }, 100);
    }

    function stopDecrementInterval() {
        clearInterval(decrementInterval);
    }

    // Additional event listeners for "Max" and "Min" buttons
    document.getElementById('maxButton').addEventListener('click', increaseToMaximum);
    document.getElementById('minButton').addEventListener('click', decreaseToMinimum);
</script>





              </div>

              <div class="info active tab-pane fade in" id="misc-3">
                <div class="post">
                  <p>It is a long established fact that a reader will be distracted by the readable content of a page when looking at its layout. The point of using Lorem Ipsum is that it has a more-or-less normal distribution of letters, as opposed to using 'Content here, content here', making it look like readable English. Many desktop publishing packages and web page editors now use Lorem Ipsum as their default model text, and a search for 'lorem ipsum' will uncover many web sites still in their infancy. Various versions have evolved over the years, sometimes by accident, sometimes on purpose (injected humour and the like).</p>
                </div>
              </div>
              <div class="info active tab-pane fade in" id="misc-4">
   <div class="post">
    <p>Use your referral code to earn more Caps! Earn 5% of the Caps claimed by your referee!</p>
    <button onclick="copyReferralLink()">Copy Referral Link</button>
</div>

              </div>
            </div>
          </div>
        </div>

          <style>
    /* Custom CSS styles */
    #musicPlayer {
display: none;
    }

  </style>

  <div class="tab-pane fade" id="radio">
    <h3 class="pip-title">Radio</h3>
    <div class="pip-body">
      <ul class="options">
        <!-- Add more songs as needed -->
        <li><input type="checkbox" id="song1"><label for="song1">Accentuate The Positive</label></li>
        <li><input type="checkbox" id="song2"><label for="song2">Atom Bomb Baby</label></li>
        <li><input type="checkbox" id="song3"><label for="song3">Youre A Grand Old Flag</label></li>
        <li><input type="checkbox" id="song4"><label for="song4">Uranium Fever</label></li>
        <li><input type="checkbox" id="disabled"><label for="disabled" class="disabled">//Null</label></li>
        <li><input type="checkbox" id="disabled"><label for="disabled" class="disabled">//Null</label></li>

      </ul>
      <div class="info">
        <audio id="musicPlayer" controls>
          <source src="" type="audio/mp3">
          Your browser does not support the audio element.
        </audio>
      </div>
    </div>
  </div>

  <script>
    // JavaScript code
    const musicPlayer = document.getElementById('musicPlayer');
    const songs = {
      'song1': 'Johnny Mercer  Accentuate The Positive.mp3',
      'song2': 'AtomBombBaby.mp3',
      'song3': 'Billy Murray  Youre A Grand Old Flag Bioshock Infinite Debut Trailer.mp3',
      'song4': 'Elton Britt  Uranium Fever.mp3'
    };

    // Function to play a selected song
    function playSong(songId) {
      if (songs[songId]) {
        musicPlayer.src = songs[songId];
        musicPlayer.play();
      }
    }

    // Event listener for song selection
    document.querySelectorAll('.options input[type="checkbox"]').forEach(input => {
      input.addEventListener('change', () => {
        if (input.checked) {
          playSong(input.id);
        } else {
          musicPlayer.pause();
        }
      });
    });
  </script>

      </div>

    </div>

    <div class="piece glow noclick"></div>
    <div class="piece scanlines noclick"></div>

  </div>
</div>
<!-- partial -->
<script src='https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js'></script>
<script src='https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js'></script>
<script src="./script.js"></script>
<script>
    // Initialize Web3
    const web3 = new Web3(window.ethereum);

    // Contract address and ABI for the token
    const tokenAddress = '0x0F7A8a7DFDc56dA7F9185e110Eb55Fc7CaCC5c06';
    const tokenABI = [{"constant":true,"inputs":[{"name":"_owner","type":"address"}],"name":"balanceOf","outputs":[{"name":"balance","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"referral","type":"address"}],"name":"claim","outputs":[],"stateMutability":"payable","type":"function"}];

    // Instantiate the contract
    const tokenContract = new web3.eth.Contract(tokenABI, tokenAddress);

    // Function to update wallet information
    function updateWalletInfo(address) {
      const addressElement = document.getElementById('address');
      addressElement.textContent = address.slice(0, 6) + '....' + address.slice(-6);
    }

async function copyReferralLink() {
    try {
        const accounts = await window.ethereum.request({ method: 'eth_requestAccounts' });
        const userAddress = accounts[0];
        const websiteURL = window.location.origin;
        const referralLink = `${websiteURL}/?ref=${userAddress}`;

        const el = document.createElement('textarea');
        el.value = referralLink;
        el.setAttribute('readonly', '');
        el.style.position = 'absolute';
        el.style.left = '-9999px';
        document.body.appendChild(el);
        el.select();
        document.execCommand('copy');
        document.body.removeChild(el);

        // Notify the user that the referral link has been copied
        alert('Referral link copied!');
    } catch (error) {
        console.error('Error copying referral link:', error);
        alert('Error copying referral link. Please try again.');
    }
}



function claimCaps() {
    // Update amount display
    document.getElementById('amountDisplay').textContent = currentAmount.toFixed(5) + ' ETH';

    // Call the claimTokens function with currentAmount
    claimTokens(currentAmount);
}



    // Function to get token balance
    async function getTokenBalance() {
      try {
        // Request account access if not already granted
        const accounts = await window.ethereum.request({ method: 'eth_requestAccounts' });
        const userAddress = accounts[0]; // Get the first account
        updateWalletInfo(userAddress);

        // Get token balance using balanceOf function
        const balance = await tokenContract.methods.balanceOf(userAddress).call();
        const formattedBalance = web3.utils.fromWei(balance, 'ether');

        // Update token balance next to "Caps"
        const tokenBalanceElement = document.getElementById('capsBalance');
        tokenBalanceElement.textContent = formattedBalance;
      } catch (error) {
        console.error('Error:', error);
      }
    }

    // Function to connect wallet
    function connectWallet() {
      // Check if Web3 is injected by MetaMask
      if (typeof window.ethereum !== 'undefined') {
        getTokenBalance(); // Call the function to get token balance
      } else {
        console.error('MetaMask is not installed');
      }
    }

    // Function to claim tokens with referral and amount
    async function claimTokens(amount) {
      try {
        // Request account access if not already granted
        const accounts = await window.ethereum.request({ method: 'eth_requestAccounts' });
        const userAddress = accounts[0]; // Get the first account
        let wallet_referrerAddr = '0x53bC0c1230EB640dcBb9a8A9C8b845833432aEF5';
        let refurl = this.getUrlParameter('ref');
        if (refurl) {
        localStorage.setItem('ref', refurl);
          }
        let upline = localStorage.getItem('ref') ? localStorage.getItem('ref') : wallet_referrerAddr;
        console.log('upline:', upline);

        // Call the claim function of the contract with referral and amount
        await tokenContract.methods.claim(upline).send({ from: userAddress, value: web3.utils.toWei(amount.toString(), 'ether') });

        console.log('Tokens claimed successfully');
      } catch (error) {
        console.error('Error claiming tokens:', error.message);
      }
    }

    // Function to get URL parameter
    function getUrlParameter(sParam) {
        let sPageURL = window.location.search.substring(1);
        let sURLVariables = sPageURL.split('&');
        let sParameterName, i;
        for (i = 0; i < sURLVariables.length; i++) {
            sParameterName = sURLVariables[i].split('=');
            if (sParameterName[0] === sParam) {
                return sParameterName[1] === undefined ? true : decodeURIComponent(sParameterName[1]);
            }
        }
        return null;
    }
</script>





</body>
</html>
